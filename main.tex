%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Masters/Doctoral Thesis 
% LaTeX Template
% Version 1.43 (17/5/14)
%
% This template has been downloaded from:
% http://www.LaTeXTemplates.com
%
% Original authors:
% Steven Gunn 
% http://users.ecs.soton.ac.uk/srg/softwaretools/document/templates/
% and
% Sunil Patel
% http://www.sunilpatel.co.uk/thesis-template/
%
% License:
% CC BY-NC-SA 3.0 (http://creativecommons.org/licenses/by-nc-sa/3.0/)
%
% Note:
% Make sure to edit document variables in the Thesis.cls file
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%----------------------------------------------------------------------------------------
%	PACKAGES AND OTHER DOCUMENT CONFIGURATIONS
%----------------------------------------------------------------------------------------

\documentclass[11pt, oneside]{Thesis} % The default font size and one-sided printing (no margin offsets)

\graphicspath{{Pictures/}} % Specifies the directory where pictures are stored
\usepackage{times}
\usepackage{pdfpages}
\usepackage{subfigure}
\usepackage[square, numbers, comma, sort&compress]{natbib} % Use the natbib reference package - read up on this to edit the reference style; if you want text (e.g. Smith et al., 2012) for the in-text references (instead of numbers), remove 'numbers' 
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{listings}

\hypersetup{urlcolor=blue, colorlinks=true} % Colors hyperlinks in blue - change to black if annoying
\title{\ttitle} % Defines the thesis title - don't touch this

\begin{document}
\frontmatter % Use roman page numbering style (i, ii, iii, iv...) for the pre-content pages

\setstretch{1.3} % Line spacing of 1.3

% Define the page headers using the FancyHdr package and set up for one-sided printing
\fancyhead{} % Clears all page headers and footers
\rhead{\thepage} % Sets the right side header to show the page number
\lhead{} % Clears the left side page header

\pagestyle{fancy} % Finally, use the "fancy" page style to implement the FancyHdr headers

\newcommand{\HRule}{\rule{\linewidth}{0.5mm}} % New command to make the lines in the title page
\newcommand{\datasetunimore} {Interactive Museum}
\newcommand{\argmax}{\arg\!\max}
% PDF meta-data
\hypersetup{pdftitle={\ttitle}}
\hypersetup{pdfsubject=\subjectname}
\hypersetup{pdfauthor=\authornames}
\hypersetup{pdfkeywords=\keywordnames}

%----------------------------------------------------------------------------------------
%	TITLE PAGE
%----------------------------------------------------------------------------------------

\begin{titlepage}

\begin{center}
\textsc{\Large \bf \univname}\\[0.5cm] % University name
\textsc{\large Dipartimento di Ingegneria ``Enzo Ferrari"}\\[0.2cm] % Thesis type
%\HRule \\ % Horizontal line
\textsc{\large Corso di Laurea Magistrale in Ingegneria Informatica}\\[5.5cm] % Thesis type

\HRule \\[0.6cm] % Horizontal line
{\huge \bfseries \ttitle}\\[0.4cm] % Thesis title
\HRule \\[1.5cm] % Horizontal line
 
\begin{minipage}{0.4\textwidth}
\begin{flushleft} \large
\emph{Candidato:}\\
\authornames % Author name - remove the \href bracket to remove the link
\end{flushleft}
\end{minipage}
\begin{minipage}{0.4\textwidth}
\begin{flushright} \large
\emph{Relatore:} \\
\supname \\ % Supervisor name - remove the \href bracket to remove the link  
\emph{Correlatore:} \\
\cosupname \\ % Supervisor name - remove the \href bracket to remove the link  
\end{flushright}
\end{minipage}\\[5.5cm]
 
%\large \textit{A thesis submitted in fulfilment of the requirements\\ for the degree of \degreename}\\[0.3cm] % University requirement text
%\textit{in the}\\[0.4cm]
%\groupname\\\deptname\\[2cm] % Research group name and department name
 
\textsc{\large Anno Accademico 2013-2014}\\[4cm] % Date
%\includegraphics{Logo} % University/department logo - uncomment to place it
 
\vfill
\end{center}

\end{titlepage}

%----------------------------------------------------------------------------------------
%	DECLARATION PAGE
%	Your institution may give you a different text to place here
%----------------------------------------------------------------------------------------

%\Declaration{
%
%\addtocontents{toc}{\vspace{1em}} % Add a gap in the Contents, for aesthetics
%
%I, \authornames, declare that this thesis titled, '\ttitle' and the work presented in it are my own. I confirm that:
%
%\begin{itemize} 
%\item[\tiny{$\blacksquare$}] This work was done wholly or mainly while in candidature for a research degree at this University.
%\item[\tiny{$\blacksquare$}] Where any part of this thesis has previously been submitted for a degree or any other qualification at this University or any other institution, this has been clearly stated.
%\item[\tiny{$\blacksquare$}] Where I have consulted the published work of others, this is always clearly attributed.
%\item[\tiny{$\blacksquare$}] Where I have quoted from the work of others, the source is always given. With the exception of such quotations, this thesis is entirely my own work.
%\item[\tiny{$\blacksquare$}] I have acknowledged all main sources of help.
%\item[\tiny{$\blacksquare$}] Where the thesis is based on work done by myself jointly with others, I have made clear exactly what was done by others and what I have contributed myself.\\
%\end{itemize}
% 
%Signed:\\
%\rule[1em]{25em}{0.5pt} % This prints a line for the signature
% 
%Date:\\
%\rule[1em]{25em}{0.5pt} % This prints a line to write the date
%}

\clearpage % Start a new page

%----------------------------------------------------------------------------------------
%	QUOTATION PAGE
%----------------------------------------------------------------------------------------

%\pagestyle{empty} % No headers or footers for the following pages
%
%\null\vfill % Add some space to move the quote down the page a bit
%
%\textit{``Thanks to my solid academic training, today I can write hundreds of words on virtually any topic without possessing a shred of information, which is how I got a good job in journalism."}
%
%\begin{flushright}
%Dave Barry
%\end{flushright}
%
%\vfill\vfill\vfill\vfill\vfill\vfill\null % Add some space at the bottom to position the quote just right
%
%\clearpage % Start a new page

%----------------------------------------------------------------------------------------
%	ABSTRACT PAGE
%----------------------------------------------------------------------------------------

\addtotoc{Abstract in lingua italiana} % Add the "Abstract" page entry to the Contents
%
\abstract{\addtocontents{toc}{\vspace{1em}} % Add a gap in the Contents, for aesthetics
%
%The Thesis Abstract is written here (and usually kept to just this page). The page is kept centered vertically so can expand into the blank space above the title too\ldots
Il regolamento della Facoltà di Ingegneria di Modena prevede che le tesi scritte in lingua inglese debbano contenere un'ampia sintesi dei contenuti in lingua italiana: in accordo a questa regola, proponiamo un sunto degli algoritmi, delle tecniche e dei risultati che verranno delineati. Si noti che non si tratta di un sunto esaustivo, e che non è possibile valutare la tesi dalla semplice lettura di queste righe. Per una descrizione più dettagliata e più rigorosa, e per i risultati sperimentali ottenuti, si rimanda al testo in inglese.

Questa tesi tratta dello sviluppo di nuovi algoritmi per la segmentazione delle mani e il riconoscimento dei gesti in video registrati da telecamere ego-centriche, cioè posizionate in maniera solidale con l'utente. Nel nostro caso, dopo aver studiato le proprietà di diverse posizioni e delle relative inquadrature, si è scelto di porre le telecamere sulla testa dell'utente o sul petto. Il fine degli algoritmi e delle tecniche proposte è quello di creare nuove modalità di interazione con opere d'arte, in ambiente museale o in generale di \textit{cultural heritage}: il visitatore, dopo aver indossato una telecamera ego-vision e un dispositivo di elaborazione wearable, può richiedere  informazioni sull'opera d'arte che sta visualizzando replicando con le mani gli stessi gesti che utilizzerebbe per chiedere informazioni a una guida. L'idea sottostante gli algoritmi che proponiamo, dunque, è che si possa costruire un nuovo tipo di interfaccia uomo-macchina, non più materiale, come le interfacce a cui siamo abituati, ma del tutto immateriale, e che si basa sul semplice movimento delle mani.

Per poter identificare gesti espressi attraverso le mani, è necessario innanzitutto identificare le mani stesse. Pertanto, nel capitolo 3 proponiamo un nuovo algoritmo di segmentazione delle mani, che parte da una fase di pre-segmentazione in superpixels e viene costruito in modo da essere stabile a diverse condizioni di illuminazione e in modo da produrre maschere di segmentazione coerenti sia dal punto di vista spaziale che da quello temporale. Dopo aver pre-segmentato il frame in superpixels, utilizzando l'algoritmo SLIC  \cite{achanta12} (si veda la figura \ref{fig:SLIC} per un esempio), i singoli superpixels vengono classificati mediante una pluralità di classificatori Random Forest, ognuno dei quali è costruto in modo da imparare l'apparenza delle mani in una determinata condizione di illuminazione. A tempo di test, vengono selezionati i classificatori più vicini alle condizioni di illuminazione che si presentano: le loro predizioni vengono poi pesate per produrre una stima finale dell'appartenenza di ciascun superpixel alla mano. Una volta classificato ogni superpixel modo indipendente dagli altri, intervengono le sopracitate tecniche di coerenza spaziale e temporale, che agiscono a livello di pixel. La coerenza temporale fa si che la predizione del singolo pixel sia espressa come somma pesata delle predizioni dei frame precedenti, coprendo in questo modo errori di classificazione estemporanei. D'altro canto, le predizioni così ottenute vengono inserite nell'algoritmo GrabCut \cite{rother04}, che provvede a rivedere i contorni della maschera di segmentazione applicando iterativamente il Graph Cut e basandosi su modelli colore ottenuti tramite misture di gaussiane. La pipeline così ottenuta viene testata su dataset pubblicamente disponibili e su dataset di nostra produzione, dimostrando performances migliori dello stato dell'arte presente in letteratura (si veda la tabella \ref{tab:comparision_hand}).

Una volta discusso il problema della segmentazione delle mani, la tesi si concentra sul riconoscimento dei gest all'interno di sequenze di frames di lunghezza fissa. La tecnica che proponiamo, anche in questo caso, supera gli approcci esistenti di riconoscimento dei gesti e delle azioni (tabella \ref{cambridge}), ed è dunque di interesse anche da un punto di vista di ricerca. L'idea è quella di estrarre punti di interesse nelle regioni delle mani, e tracciarli durante il video. Le traiettorie così ottenute vengono descritte non solo nella loro forma (mediante un Trajectory Descriptor ispirato da \cite{wang:2011:inria-00583818:1}), ma anche nel moto e nell'apparenza di un loro intorno, tramite i descrittori HOG, HOF e MBH. Si ottiene così, data una sequenza di frames, un numero variabile di traiettorie, che viene poi codificato mediante un approccio Bag of Words (si veda per un dettaglio la sezione \ref{trajectory-descr}). Il descrittore finale, che dunque è un'istogramma, viene power-normalizzato e quindi classificato tramite un classificatore a massimo margine lineare SVM.

L'ultimo capitolo, infine, si occupa di estendere l'approccio di riconoscimento dei gesti, pensato per sequenze di lunghezza fissa, al caso del riconoscimento di gesti, in tempo reale, da un frame stream proveniente da una telecamera. Per fare ciò, ci ispiriamo ai problemi di \textit{label sequence learning}, proponiamo una versione leggermente modificata dei nostri descrittori e sostituiamo il classificatore lineare SVM con un più complesso classificatore SVM strutturato, a sua volta ispirato agli Hidden Markov Models. In altre parole, si modificano i descrittori in modo da passare da descrittori relativi a una sequenza di frames a descrittori relativi al singolo frames, e si affida all'SVM strutturato il compito di catturare le dipendenze temporali tra più frames. Compito del classificatore strutturato è infatti, in questo caso, associare una label (corrispondente a un gesto o a un \textit{non gesto}, cioè a una situazione in cui non viene compiuto alcun gesto) a ciascun frames, tenendo conto delle dipendenze temporali tra la label del frame corrente e i descrittori dei frame precenti, e tra la label del frame corrente e le label associate ai frames precedenti. Rispetto al caso del classificatore lineare, si guadagna sia in termini di una migliore descrizione delle dipendenze temporali, sia perchè si ha una classificazione on-line, in contrasto con quella precedente, che necessariamente ha un ritardo di alcuni frames.

Come si è detto l'ultimo capitolo vuole proporre un riconoscimento dei gesti in tempo reale. Per questo scegliamo una piattaforma wearable su cui implementare i nostri algoritmi ed effettuare test, la board Odroid XU, e impieghiamo diverse tecniche di ottimizzazione, sia per sfruttare le potenzialità di un'architettura multicore mediante il multithreading, sia per sfruttare le capacità SIMD dei singoli processori. Inoltre, valutiamo l'uso della GPU embedded nel dispositivo. Impiegando tali tecniche di ottimizzazione passiamo da una prima versione sequenziale da 4.3 frames/s a una versione definitiva da 14 frames/s, capace di estrarre traiettorie di buona qualità in tempo reale.  L'implementazione real-time così ottenuta, costituisce di fatto la realizzazione dell'interfaccia uomo-macchina basata su gesti obiettivo della tesi, e viene testata in due applicazioni reali: in una \textit{ego-vision jacket}, in cui la board viene posta all'interno di una giacca da uomo, e si affrontano i conseguenti problemi hardware di surriscaldamento dei processori, e una \textit{gesture-based interface} per GUI e applicazioni desktop, con la quale è possibile controllare, mediante il movimento delle mani, interfacce grafiche pensate per ambienti desktop, come presentazioni Power Point (si veda, a tal proposito, la demo diponibile al seguente URL: \url{http://www.lorenzobaraldi.com/files/EgoVision_HCI.wmv}).

Il lavoro svolto è inoltre testimoniato da due \textit{papers}, pubblicati in due workshops, e due articoli su rivista, attualmente in fase di revisione.
}
%
\clearpage % Start a new page

%----------------------------------------------------------------------------------------
%	DEDICATION
%----------------------------------------------------------------------------------------
\mainmatter
\setstretch{1.3} % Return the line spacing back to 1.3

\pagestyle{empty} % Page style needs to be empty for this page

\dedicatory{To Emanuela} % Dedication text

\addtocontents{toc}{\vspace{2em}} % Add a gap in the Contents, for aesthetics

%----------------------------------------------------------------------------------------
%	ACKNOWLEDGEMENTS
%----------------------------------------------------------------------------------------

\setstretch{1.3} % Reset the line-spacing to 1.3 for body text (if it has changed)

\acknowledgements{\addtocontents{toc}{\vspace{1em}} % Add a gap in the Contents, for aesthetics

Foremost, I would like to express my sincere gratitude to my advisors Prof. Rita Cucchiara and Dr. Giuseppe Serra for the continuous support of my study, for their patience, motivation, enthusiasm, and knowledge. Their guidance helped me in all the time of research and writing of this thesis. I could not have imagined having better advisors for my study.

Besides my advisors, I would like to thank the rest of the Imagelab research group: Costantino Grana, Simone Calderara, Michele Fornaciari, Marco Manfredi, Paolo Santinelli, Augusto Pieracci, Roberto Vezzani, Franesco Solera, Martino Lombardi and Patrizia Varini, for their encouragement, insightful comments, and hard questions. I am also grateful to Prof. Greg Mori, for enlightening me the first glance of research during a visit in Modena.

Special thanks go to my labmates Stefano Alletto and  Francesco Paci, for the stimulating discussions, for the days we were working together before deadlines, and for all the fun we have had in the last months. Also I thank my friends Chiara Ferrari, Emanuele Benatti, Xhensila Doda, Davide Setti, and in particular Michela Benedetti, who encouraged me to study computer vision.

Last but not the least, I would like to thank my parents Franco and Elisabetta, for giving birth to me at the first place and supporting me throughout my life, and my sister Alessia.
}
\clearpage % Start a new page

%----------------------------------------------------------------------------------------
%	LIST OF CONTENTS/FIGURES/TABLES PAGES
%----------------------------------------------------------------------------------------

\pagestyle{fancy} % The page style headers have been "empty" all this time, now use the "fancy" headers as defined before to bring them back

\lhead{\emph{Contents}} % Set the left side page header to "Contents"
\tableofcontents % Write out the Table of Contents

\lhead{\emph{List of Figures}} % Set the left side page header to "List of Figures"
\listoffigures % Write out the List of Figures

\lhead{\emph{List of Tables}} % Set the left side page header to "List of Tables"
\listoftables % Write out the List of Tables

%----------------------------------------------------------------------------------------
%	ABBREVIATIONS
%----------------------------------------------------------------------------------------

%\clearpage % Start a new page
%
%\setstretch{1.5} % Set the line spacing to 1.5, this makes the following tables easier to read
%
%\lhead{\emph{Abbreviations}} % Set the left side page header to "Abbreviations"
%\listofsymbols{ll} % Include a list of Abbreviations (a table of two columns)
%{
%\textbf{LAH} & \textbf{L}ist \textbf{A}bbreviations \textbf{H}ere \\
%%\textbf{Acronym} & \textbf{W}hat (it) \textbf{S}tands \textbf{F}or \\
%}

%----------------------------------------------------------------------------------------
%	PHYSICAL CONSTANTS/OTHER DEFINITIONS
%----------------------------------------------------------------------------------------

%\clearpage % Start a new page
%
%\lhead{\emph{Physical Constants}} % Set the left side page header to "Physical Constants"
%
%\listofconstants{lrcl} % Include a list of Physical Constants (a four column table)
%{
%Speed of Light & $c$ & $=$ & $2.997\ 924\ 58\times10^{8}\ \mbox{ms}^{-\mbox{s}}$ (exact)\\
%% Constant Name & Symbol & = & Constant Value (with units) \\
%}

%----------------------------------------------------------------------------------------
%	SYMBOLS
%----------------------------------------------------------------------------------------

%\clearpage % Start a new page
%
%\lhead{\emph{Symbols}} % Set the left side page header to "Symbols"
%
%\listofnomenclature{lll} % Include a list of Symbols (a three column table)
%{
%$a$ & distance & m \\
%$P$ & power & W (Js$^{-1}$) \\
%% Symbol & Name & Unit \\
%
%& & \\ % Gap to separate the Roman symbols from the Greek
%
%$\omega$ & angular frequency & rads$^{-1}$ \\
%% Symbol & Name & Unit \\
%}
\newcommand{\etal}{\textit{et al.~}}
%----------------------------------------------------------------------------------------
%	THESIS CONTENT - CHAPTERS
%----------------------------------------------------------------------------------------

 % Begin numeric (1,2,3...) page numbering

\pagestyle{fancy} % Return the page headers back to the "fancy" style

% Include the chapters of the thesis as separate files from the Chapters folder
% Uncomment the lines as you write the chapters


\input{Chapters/Chapter1}

\input{Chapters/Chapter1bis}


\input{Chapters/Chapter2}

\input{Chapters/Chapter3}

\input{Chapters/Chapter4}

\input{Chapters/Conclusion}

%----------------------------------------------------------------------------------------
%	THESIS CONTENT - APPENDICES
%----------------------------------------------------------------------------------------

\addtocontents{toc}{\vspace{2em}} % Add a gap in the Contents, for aesthetics

\appendix % Cue to tell LaTeX that the following 'chapters' are Appendices

% Include the appendices of the thesis as separate files from the Appendices folder
% Uncomment the lines as you write the Appendices

\input{Appendices/AppendixA}

%\input{Appendices/AppendixC}

\addtocontents{toc}{\vspace{2em}} % Add a gap in the Contents, for aesthetics

\backmatter

%----------------------------------------------------------------------------------------
%	BIBLIOGRAPHY
%----------------------------------------------------------------------------------------

\label{Bibliography}

\lhead{\emph{Bibliography}} % Change the page header to say "Bibliography"

\bibliographystyle{unsrtnat} % Use the "unsrtnat" BibTeX style for formatting the Bibliography

\bibliography{Bibliography} % The references (bibliography) information are stored in the file named "Bibliography.bib"


\end{document}  

